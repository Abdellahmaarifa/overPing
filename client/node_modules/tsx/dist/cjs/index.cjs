"use strict";var S=require("path"),j=require("fs"),E=require("module"),i=require("get-tsconfig"),O=require("../source-map.cjs"),f=require("../index-798b46f9.cjs"),M=require("../resolve-ts-path-43f50656.cjs");require("source-map-support"),require("../node-features-84a305a1.cjs"),require("url"),require("esbuild"),require("crypto"),require("os");function d(s){return s&&typeof s=="object"&&"default"in s?s:{default:s}}var m=d(S),q=d(j),l=d(E);const P=s=>{if(s.includes("import")||s.includes("export")){const[e,n]=f.parseEsm(s);return e.length>0||n.length>0}return!1},b=/^\.{1,2}\//,A=/\.[cm]?tsx?$/,N=`${m.default.sep}node_modules${m.default.sep}`,u=process.env.TSX_TSCONFIG_PATH?{path:m.default.resolve(process.env.TSX_TSCONFIG_PATH),config:i.parseTsconfig(process.env.TSX_TSCONFIG_PATH)}:i.getTsconfig(),h=u&&i.createFilesMatcher(u),x=u&&i.createPathsMatcher(u),y=O.installSourceMapSupport(),v=l.default._extensions,R=v[".js"],D=[".cts",".mts",".ts",".tsx",".jsx"],I=[".js",".cjs",".mjs"],F=(s,e)=>{process.send&&process.send({type:"dependency",path:e});const n=D.some(t=>e.endsWith(t)),o=I.some(t=>e.endsWith(t));if(!n&&!o)return R(s,e);let r=q.default.readFileSync(e,"utf8");if(e.endsWith(".cjs")){const t=f.transformDynamicImport(e,r);t&&(r=y(t,e))}else if(n||P(r)){const t=f.transformSync(r,e,{tsconfigRaw:h==null?void 0:h(e)});r=y(t,e)}s._compile(r,e)};[".js",".ts",".tsx",".jsx"].forEach(s=>{v[s]=F}),Object.defineProperty(v,".mjs",{value:F,enumerable:!1});const _=l.default._resolveFilename.bind(l.default);l.default._resolveFilename=(s,e,n,o)=>{var r;const t=s.indexOf("?");if(t!==-1&&(s=s.slice(0,t)),x&&!b.test(s)&&!((r=e==null?void 0:e.filename)!=null&&r.includes(N))){const a=x(s);for(const p of a){const T=g(p,e,n,o);if(T)return T;try{return _(p,e,n,o)}catch{}}}const c=g(s,e,n,o);return c||_(s,e,n,o)};const g=(s,e,n,o)=>{const r=M.resolveTsPath(s);if(e!=null&&e.filename&&A.test(e.filename)&&r)for(const t of r)try{return _(t,e,n,o)}catch(c){const{code:a}=c;if(a!=="MODULE_NOT_FOUND"&&a!=="ERR_PACKAGE_PATH_NOT_EXPORTED")throw c}};
